<!-- ========================================
     HTML STARTS HERE
     File: index.html
     Storm Surge Weather Dashboard - Fixed Version
======================================== -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Storm Surge Weather ‚Äî NEXRAD Level II Radar</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Mapbox GL JS -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  
  <!-- Local CSS -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="app-container">
  <!-- Top Bar -->
  <div class="top-bar">
    <button id="settingsBtn" class="top-btn" title="Settings">‚öôÔ∏è</button>
    <div class="location-display">
      <span id="currentLocation">San Francisco, CA</span>
    </div>
    <button id="searchBtn" class="top-btn" title="Search">üîç</button>
  </div>

  <!-- Map Container -->
  <div id="map"></div>

  <!-- Click Marker (Red Pin) -->
  <div id="clickMarker" class="click-marker hidden">
    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="#FF0000"/>
    </svg>
  </div>

  <!-- Detailed Weather Panel (Left Side - Original Style) -->
  <div id="weatherPanel" class="weather-panel-detailed hidden">
    <div class="panel-header-detailed">
      <h3 id="panelLocationName">Weather Details</h3>
      <button id="closeWeatherPanel" class="close-btn">√ó</button>
    </div>
    
    <div class="panel-content-detailed">
      <div class="location-info-detailed">
        <div id="panelLocationAddress" class="location-address">Click map for weather</div>
        <div id="panelLocationCoords" class="location-coords"></div>
      </div>

      <!-- Active Warnings -->
      <div id="panelWarningsSection" class="panel-warnings-section hidden">
        <h4>‚ö†Ô∏è Active Alerts</h4>
        <div id="panelWarningsList" class="panel-warnings-list"></div>
      </div>

      <!-- Current Weather -->
      <div class="current-weather-detailed">
        <div class="temp-display-detailed">
          <span id="panelCurrentTemp">--¬∞</span>
          <div class="temp-details-detailed">
            <div id="panelFeelsLike">Feels like --¬∞</div>
            <div id="panelConditions">Loading...</div>
            <div id="panelPrecipType" class="precip-type"></div>
          </div>
        </div>
      </div>
      
      <!-- Weather Details Grid -->
      <div class="weather-details-grid">
        <div class="detail-item-grid">
          <span class="label">Humidity</span>
          <span id="panelHumidity" class="value">--%</span>
        </div>
        <div class="detail-item-grid">
          <span class="label">Wind</span>
          <span id="panelWindSpeed" class="value">-- mph</span>
        </div>
        <div class="detail-item-grid">
          <span class="label">Wind Direction</span>
          <span id="panelWindDirection" class="value">--</span>
        </div>
        <div class="detail-item-grid">
          <span class="label">Pressure</span>
          <span id="panelPressure" class="value">-- mb</span>
        </div>
        <div class="detail-item-grid">
          <span class="label">Visibility</span>
          <span id="panelVisibility" class="value">-- mi</span>
        </div>
        <div class="detail-item-grid">
          <span class="label">UV Index</span>
          <span id="panelUvIndex" class="value">--</span>
        </div>
        <div class="detail-item-grid">
          <span class="label">Dew Point</span>
          <span id="panelDewPoint" class="value">--¬∞</span>
        </div>
        <div class="detail-item-grid">
          <span class="label">Cloud Cover</span>
          <span id="panelCloudCover" class="value">--%</span>
        </div>
      </div>
      
      <!-- Hourly Forecast -->
      <div class="hourly-forecast-detailed">
        <h4>24-Hour Forecast</h4>
        <div id="panelHourlyData" class="hourly-container-detailed">
          Loading...
        </div>
      </div>

      <!-- Daily Forecast -->
      <div class="daily-forecast-detailed">
        <h4>7-Day Forecast</h4>
        <div id="panelDailyData" class="daily-container-detailed">
          Loading...
        </div>
      </div>
    </div>
  </div>

  <!-- Warnings List (Top Right) -->
  <div id="warningsList" class="warnings-list hidden">
    <div class="warnings-header">
      <h3>‚ö†Ô∏è Alerts (<span id="alertCount">0</span>)</h3>
      <button id="closeWarnings" class="close-warnings-btn">√ó</button>
    </div>
    <div id="warningsContent" class="warnings-content">
      <!-- Populated by JS -->
    </div>
  </div>

  <!-- Skywarn Reports Panel -->
  <div id="skywarnPanel" class="skywarn-panel hidden">
    <div class="panel-header">
      <h3>üëÅÔ∏è Skywarn Reports</h3>
      <button class="close-panel-btn" onclick="document.getElementById('skywarnPanel').classList.add('hidden')">√ó</button>
    </div>
    <div id="skywarnContent" class="panel-content">
      <!-- Populated by JS -->
    </div>
  </div>

  <!-- Radar Legend (Side) -->
  <div class="radar-legend">
    <div class="legend-title" id="legendTitle">Reflectivity (dBZ)</div>
    <div class="legend-gradient" id="legendGradient">
      <!-- Color gradient -->
    </div>
    <div class="legend-labels">
      <span>0</span>
      <span>20</span>
      <span>40</span>
      <span>60</span>
      <span>80</span>
    </div>
  </div>

  <!-- Bottom Control Bar -->
  <div class="bottom-controls">
    <div class="time-display">
      <span id="currentTime">12:00 PM</span>
      <span id="timeMode" class="time-badge">LIVE</span>
    </div>
    
    <div class="playback-controls">
      <button id="playPauseBtn" class="play-btn">‚è∏Ô∏è</button>
      <div class="time-slider-wrapper">
        <input type="range" id="timeSlider" min="0" max="11" value="11" step="1" />
      </div>
      <button id="alertsBtn" class="alerts-btn">
        <span class="alerts-icon">‚ö†Ô∏è</span>
        <span id="alertBadge" class="alert-badge hidden">0</span>
      </button>
    </div>
  </div>

  <!-- Settings Modal (SCROLLABLE) -->
  <div id="settingsModal" class="modal hidden">
    <div class="modal-content settings-modal-scrollable">
      <div class="modal-header-fixed">
        <h2>‚öôÔ∏è Settings</h2>
        <button class="close-modal-btn" onclick="closeSettings()">√ó</button>
      </div>
      
      <div class="modal-body-scrollable">
        <div class="settings-section">
          <h3>Radar Settings</h3>
          
          <div class="setting-item">
            <label>Radar Product</label>
            <select id="radarProductSelect">
              <option value="base-reflectivity">Base Reflectivity</option>
              <option value="composite-reflectivity" selected>Composite Reflectivity</option>
              <option value="base-velocity">Base Velocity</option>
              <option value="storm-relative-velocity">Storm Relative Velocity</option>
              <option value="correlation-coefficient">Correlation Coefficient</option>
              <option value="differential-reflectivity">Differential Reflectivity</option>
              <option value="specific-differential-phase">Specific Differential Phase</option>
              <option value="one-hour-precipitation">One Hour Precipitation</option>
              <option value="storm-total-precipitation">Storm Total Precipitation</option>
            </select>
          </div>

          <div class="setting-item">
            <label>Tilt Angle</label>
            <select id="tiltAngleSelect">
              <option value="0.5" selected>0.5¬∞</option>
              <option value="0.9">0.9¬∞</option>
              <option value="1.3">1.3¬∞</option>
              <option value="1.8">1.8¬∞</option>
              <option value="2.4">2.4¬∞</option>
              <option value="3.1">3.1¬∞</option>
              <option value="4.0">4.0¬∞</option>
              <option value="5.1">5.1¬∞</option>
              <option value="6.4">6.4¬∞</option>
              <option value="8.0">8.0¬∞</option>
              <option value="10.0">10.0¬∞</option>
              <option value="12.0">12.0¬∞</option>
              <option value="14.6">14.6¬∞</option>
              <option value="19.5">19.5¬∞</option>
            </select>
          </div>

          <div class="setting-item">
            <label>Radar Opacity: <span id="opacityDisplay">70%</span></label>
            <input type="range" id="radarOpacity" min="0" max="100" value="70" />
          </div>
        </div>

        <div class="settings-section">
          <h3>Map Settings</h3>
          
          <div class="setting-item toggle-item">
            <label>Satellite Imagery</label>
            <div class="toggle-switch">
              <input type="checkbox" id="satelliteToggle" />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show Warning Polygons</label>
            <div class="toggle-switch">
              <input type="checkbox" id="polygonsToggle" checked />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show Lightning</label>
            <div class="toggle-switch">
              <input type="checkbox" id="lightningToggle" checked />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show Storm Fronts</label>
            <div class="toggle-switch">
              <input type="checkbox" id="frontsToggle" checked />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show SPC Outlooks</label>
            <div class="toggle-switch">
              <input type="checkbox" id="spcToggle" checked />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show TVS Signatures</label>
            <div class="toggle-switch">
              <input type="checkbox" id="tvsToggle" checked />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show Storm Tracks</label>
            <div class="toggle-switch">
              <input type="checkbox" id="tracksToggle" checked />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show Skywarn Reports</label>
            <div class="toggle-switch">
              <input type="checkbox" id="skywarnToggle" checked />
              <span class="toggle-slider"></span>
            </div>
          </div>

          <div class="setting-item toggle-item">
            <label>Show TDWR Radars</label>
            <div class="toggle-switch">
              <input type="checkbox" id="tdwrToggle" />
              <span class="toggle-slider"></span>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h3>Warning Types to Show</h3>
          
          <div class="warning-types-grid">
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Tornado Warning" />
              <span>Tornado Warning</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Severe Thunderstorm Warning" />
              <span>Severe T-Storm</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Flash Flood Warning" />
              <span>Flash Flood</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Flood Warning" />
              <span>Flood Warning</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Winter Storm Warning" />
              <span>Winter Storm</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Winter Weather Advisory" />
              <span>Winter Weather</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="High Wind Warning" />
              <span>High Wind</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Gale Warning" />
              <span>Gale Warning</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Dense Fog Advisory" />
              <span>Dense Fog</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Special Weather Statement" />
              <span>Special Weather</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Heat Advisory" />
              <span>Heat Advisory</span>
            </label>
            <label class="warning-type-checkbox">
              <input type="checkbox" checked data-warning-type="Excessive Heat Warning" />
              <span>Excessive Heat</span>
            </label>
          </div>
        </div>

        <div class="settings-section">
          <h3>Keyboard Shortcuts</h3>
          <div class="shortcuts-info">
            <div class="shortcut-row"><kbd>Space</kbd> Play/Pause Animation</div>
            <div class="shortcut-row"><kbd>‚Üê/‚Üí</kbd> Navigate Frames</div>
            <div class="shortcut-row"><kbd>W</kbd> Toggle Warnings Panel</div>
            <div class="shortcut-row"><kbd>S</kbd> Open Settings</div>
            <div class="shortcut-row"><kbd>L</kbd> Toggle Lightning</div>
            <div class="shortcut-row"><kbd>F</kbd> Toggle Fronts</div>
            <div class="shortcut-row"><kbd>Esc</kbd> Close Modals</div>
          </div>
        </div>

        <div class="settings-section">
          <h3>About</h3>
          <div class="about-info">
            <p><strong>Storm Surge Weather</strong></p>
            <p>Version 2.1</p>
            <p>NEXRAD Level II Dual-Pol Radar</p>
            <p>Data: NOAA, NWS, AWS NEXRAD</p>
            <button id="feedbackBtnInSettings" class="action-btn secondary full-width" style="margin-top: 15px;">
              üí¨ Send Feedback
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Modal -->
  <div id="searchModal" class="modal hidden">
    <div class="modal-content search-modal">
      <div class="modal-header">
        <h2>üîç Search Location</h2>
        <button class="close-modal-btn" onclick="closeSearch()">√ó</button>
      </div>
      
      <div class="modal-body">
        <div class="search-input-wrapper">
          <input type="text" id="searchInput" placeholder="City, address, or zip code..." />
        </div>
        <div id="searchResults" class="search-results-list">
          <!-- Populated by JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- Warning Detail Modal -->
  <div id="warningModal" class="modal hidden">
    <div class="modal-content warning-detail-modal">
      <div class="modal-header" id="warningModalHeader">
        <h2 id="warningModalTitle">Warning Details</h2>
        <button class="close-modal-btn" onclick="closeWarningModal()">√ó</button>
      </div>
      
      <div class="modal-body">
        <div class="warning-detail-section">
          <div class="detail-row">
            <span class="detail-label">Issued:</span>
            <span id="warningIssued" class="detail-value">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Expires:</span>
            <span id="warningExpires" class="detail-value">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Severity:</span>
            <span id="warningSeverity" class="detail-value">--</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Source:</span>
            <span id="warningSource" class="detail-value">--</span>
          </div>
        </div>

        <div class="warning-detail-section">
          <h3>Description</h3>
          <p id="warningDescription">--</p>
        </div>

        <div class="warning-detail-section">
          <h3>Affected Areas</h3>
          <div id="warningAreas" class="areas-list">--</div>
        </div>

        <div class="warning-actions">
          <button id="playWeatherRadioBtn" class="action-btn primary">
            üîä Play Weather Radio
          </button>
          <button id="shareWarningBtn" class="action-btn secondary">
            üì§ Share
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback Modal -->
  <div id="feedbackModal" class="modal hidden">
    <div class="modal-content feedback-modal">
      <div class="modal-header">
        <h2>üí¨ Send Feedback</h2>
        <button class="close-modal-btn" onclick="closeFeedback()">√ó</button>
      </div>
      
      <div class="modal-body">
        <textarea id="feedbackText" placeholder="Tell us what you think, report bugs, or suggest features..." rows="6"></textarea>
        <button id="submitFeedbackBtn" class="action-btn primary full-width">
          Send Feedback
        </button>
        <p class="feedback-note">Feedback will be sent to stormsurgee025@gmail.com</p>
      </div>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div id="loadingIndicator" class="loading-indicator hidden">
    <div class="spinner"></div>
    <p>Loading radar data...</p>
  </div>

  <!-- Toast Notifications -->
  <div id="toastContainer" class="toast-container"></div>
</div>

<!-- Local JavaScript -->
<script src="script.js"></script>

</body>
</html>
<!-- ======================================== 
     HTML ENDS HERE
======================================== -->